
# projects total:     161
# min stars count:    -1
# max projects count: 1000

name: "Execute Open Community Build plan"
on:
  workflow_call:
    inputs:
      published-scala-version:
        type: string
        description: 'Published Scala version to use, if empty new version of compiler would be build with default name based on the selected repository'
      repository-url:
        type: string
        description: "GitHub repository URL for compiler to build, ignored when published-scala-version is defined"
        default: "scala/scala3"
      repository-branch:
        type: string
        description: "GitHub repository branch for compiler to build, ignored when published-scala-version is defined"
        default: "main"
      extra-scalac-options:
        type: string
        description: "List of scalacOptions which should be used when building projects. Multiple entires should be seperated by a single comma character `,`"
        default: ""
      disabled-scalac-options:
        type: string
        description: "List of scalacOptions which should be filtered out when building projects."
        default: ""
      extra-library-dependencies:
        type: string
        description: "List of library dependencies which should be injected when building projects, in format org:artifact:version, or org::artifact:version for Scala cross version. Multiple entires should be seperated by a single semicolon character `;`. (Best effort)"
        default: ""
      execute-tests:
        type: boolean
        description: "Should the workflow execute tests of the build projects (compile only by default)"
        default: false
      custom-build-id:
        type: string
        description: "Custom buildId to use instead of autogenerated github job id"
        default: ""
    outputs:
      used-scala-version:
        description: "Version of Scala used to run the build"
        value: ${{ jobs.setup-build.outputs.scala-version }}
    secrets:
      OPENCB_ELASTIC_USER:
        required: true
      OPENCB_ELASTIC_PSWD:
        required: true
      GHCR_TOKEN:
        required: true

jobs:
  setup-build:
    runs-on: ubuntu-22.04
    continue-on-error: false
    outputs:
      scala-version:  ${{ steps.setup.outputs.scala-version }}
      maven-repo-url: ${{ steps.setup.outputs.maven-repo-url }}
    steps:
      - name: "Git Checkout"
        uses: actions/checkout@v4
      - name: "Setup build"
        uses: ./.github/actions/setup-build
        id: setup
        with:
          scala-version: ${{ inputs.published-scala-version }}
          repository-url: ${{ inputs.repository-url }}
          repository-branch: ${{ inputs.repository-branch }}

  stage-0:
    runs-on: ubuntu-22.04
    needs: [ setup-build ]
    continue-on-error: true
    strategy:
      matrix:
        include:
        - name: "7mind/sick"
        - name: "abdolence/circe-tagged-adt-codec"
        - name: "adampingel/axle-cicd"
        - name: "alexandru/alexandru"
        - name: "alexarchambault/case-app-entrypoint-annotation"
        - name: "alexarchambault/scalacon-2022-demo"
        - name: "alexarchambault/scalacon2022-demo"
        - name: "apache/logging-log4j-scala"
        - name: "aptusproject/aptus-core"
        - name: "argon-lang/async-util"
        - name: "argon-lang/esexpr"
        - name: "armanbilge/cheshire"
        - name: "armanbilge/circe"
        - name: "beangle/boot"
        - name: "beangle/cache"
        - name: "beangle/cdi"
        - name: "beangle/commons"
        - name: "beangle/data"
        - name: "beangle/ems"
        - name: "beangle/otk"
        - name: "beangle/security"
        - name: "beangle/serializer"
        - name: "beangle/spa"
        - name: "beangle/template"
        - name: "beangle/web"
        - name: "beangle/webmvc"
        - name: "bot4s/zmatrix"
        - name: "carlos-verdes/funkode"
        - name: "caspercommunityio/casper-scala-sdk"
        - name: "cchantep/play-reactivemongo"
        - name: "cequence-io/openai-scala-client"
        - name: "cequence-io/pinecone-scala"
        - name: "cequence-io/ws-client"
        - name: "ciaraobrien/dottytags"
        - name: "clulab/processors"
        - name: "clulab/scala-transformers"
        - name: "com-lihaoyi/ammonite"
        - name: "coursier/coursier"
        - name: "coursier/sbt-coursier"
        - name: "dacr/lorem-ipsum"
        - name: "dataoperandz/cassper"
        - name: "davidledwards/zookeeper"
        - name: "dicklieber/wa9nnn-util"
        - name: "dmurvihill/courier"
        - name: "dmytromitin/dotty-patched"
        - name: "eclipse-pass/pass-java-client"
        - name: "eed3si9n/sbt-coursier"
        - name: "errors4s/errors4s-core-circe"
        - name: "es-meta/esmeta"
        - name: "etorreborre/specs2"
        - name: "finos/morphir"
        - name: "finos/morphir-scala"
        - name: "firstbirdtech/emergence"
        - name: "garlandus/augment"
        - name: "gemini-hlsw/lucuma-schemas"
        - name: "guardian/support-frontend"
        - name: "hinadt/hina-cloud-android-plugin"
        - name: "hughsimpson/scalamock"
        - name: "iltotore/iron"
        - name: "io-github-nafg/bleep-plugins"
        - name: "io-github-nafg/zio-messaging"
        - name: "io-github-nafg/zio-tcn"
        - name: "jam01/json-schema"
        - name: "jcouyang/meow"
        - name: "jd557/minart"
        - name: "jphmrst/scala-outlines"
        - name: "jsfwa/zio-cassandra"
        - name: "julianpeeters/dc10-cats"
        - name: "julianpeeters/dc10-sbt"
        - name: "julianpeeters/dc10-scalaq"
        - name: "kag0/ninny-json"
        - name: "kailuowang/pencil"
        - name: "kamon-io/kamon-http4s"
        - name: "karazinscalausersgroup/circe-literal-extras"
        - name: "karimagnusson/io-path"
        - name: "karimagnusson/kuzminki-pekko"
        - name: "karimagnusson/kuzminki-play"
        - name: "karimagnusson/zio-path"
        - name: "kevin-lee/can-equal"
        - name: "kevin-lee/just-fp"
        - name: "kubukoz/sup"
        - name: "labra/srdf"
        - name: "lhns/fs2-functork"
        - name: "line/armeria"
        - name: "logicovercode/app-core"
        - name: "lorandszakacs/sprout"
        - name: "lucidsoftware/twirl_compiler_cli"
        - name: "makenowjust-labs/lite"
        - name: "makkarpov/explicits"
        - name: "massimosiani/skunk"
        - name: "mbari-org/commons"
        - name: "mdedetrich/scalajson"
        - name: "mercurievv/minuscles"
        - name: "mixql/mixql-platform-demo"
        - name: "mkurz/deadbolt-2-java"
        - name: "mpollmeier/scala-repl-pp"
        - name: "mrumkovskis/wabase"
        - name: "nafg/dialogue-state"
        - name: "narma/zio-docker"
        - name: "nau/scalus"
        - name: "neandertech/jsonrpclib"
        - name: "newrelic/newrelic-java-agent"
        - name: "nickburkard/aws-cdk-scala"
        - name: "nrinaudo/kantan.repl"
        - name: "nrktkt/ninny-json"
        - name: "oleg-py/shironeko"
        - name: "openlink/virtuoso-opensource"
        - name: "ossuminc/riddl"
        - name: "outr/testy"
        - name: "oyvindberg/bleep"
        - name: "oyvindberg/ryddig"
        - name: "oyvindberg/tui-scala"
        - name: "oyvindberg/typo"
        - name: "pac4j/play-pac4j"
        - name: "pdal/java"
        - name: "percontmx/cfdi-java"
        - name: "pityka/aten-scala"
        - name: "pjfanning/jackson-scala3-reflection-extensions"
        - name: "pme123/camundala-dsl"
        - name: "primetalk/typed-ontology"
        - name: "quafadas/dedav4s"
        - name: "quafadas/scautable"
        - name: "rjolly/scas"
        - name: "rocketfuel/sdbc"
        - name: "rssh/scala-gopher"
        - name: "sbrunk/tokenizers-scala"
        - name: "sbt/sbt-vimquit"
        - name: "scala-js/scala-js-macrotask-executor"
        - name: "scala/toolkit"
        - name: "sciss/pdflitz"
        - name: "sciss/scala-chart"
        - name: "sciss/span"
        - name: "sdrafahl/migratepipeline"
        - name: "sensorsdata/sa-sdk-android-plugin2"
        - name: "sief/play-guard"
        - name: "simkoc/scala-processes"
        - name: "simy4/xpath-to-xml"
        - name: "sscarduzio/elasticsearch-readonlyrest-plugin"
        - name: "stryker-mutator/mutation-testing-elements"
        - name: "swaldman/fossilphant"
        - name: "t83714/elastic4s"
        - name: "tabdulradi/mazboot"
        - name: "thinkingdataanalytics/android-sdk"
        - name: "tinkoff/muffin"
        - name: "tinkoff/oolong"
        - name: "todokr/grokschema"
        - name: "tomasmikula/nutcracker"
        - name: "troungtam70/wezterm"
        - name: "valdemargr/gql"
        - name: "vigoo/zio-aws"
        - name: "vigoo/zio-http-rust"
        - name: "virtuslab/besom"
        - name: "virtuslab/pretty-stacktraces"
        - name: "wangzaixiang/wjson"
        - name: "wiringbits/wiringbits-scala-newbie-warts"
        - name: "xebia-functional/xef"
        - name: "xuwei-k/wartremover-scalikejdbc"
        - name: "zio-archive/caliban-deriving"
        - name: "zio-archive/zio-openai"
        - name: "zio/zio-aws"
        - name: "zygfryd/scala-zygf-cement"
    steps:
      - name: "Git Checkout"
        uses: actions/checkout@v4
      - name: "Build project"
        uses: ./.github/actions/build-project
        with:
          project-name: ${{ matrix.name }}
          custom-build-id: ${{ inputs.custom-build-id }}
          extra-scalac-options: ${{ inputs.extra-scalac-options }}
          disabled-scalac-options: ${{ inputs.disabled-scalac-options }}
          extra-library-dependencies: ${{ inputs.extra-library-dependencies }}
          execute-tests: ${{ inputs.execute-tests }}
          scala-version: ${{ needs.setup-build.outputs.scala-version }}
          maven-repo-url: ${{ needs.setup-build.outputs.maven-repo-url }}
          elastic-user: ${{ secrets.OPENCB_ELASTIC_USER }}
          elastic-password: ${{ secrets.OPENCB_ELASTIC_PSWD }}
          container-registry-username: ${{ github.actor }}
          container-registry-token: ${{ secrets.GHCR_TOKEN }}
